<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="user010101lite">
	
	<select id="selectTableCreate" parameterType="hashmap" resultType ="HashMap">
			SELECT CASE WHEN COUNT(*) = 1 THEN 'Y' ELSE 'N' END AS CREATIONYN
			FROM INFORMATION_SCHEMA.TABLES
			WHERE TABLE_NAME = 'USER01'
	</select>
	
	<insert id="insertTableCreate" parameterType="hashmap">
			CREATE TABLE USER01 (
    			ID CHAR(20),
    			PASS CHAR(20) NOT NULL,
    			NAME CHAR(20),
    			PRIMARY KEY (ID)
			)
	</insert>
	
	<insert id="insertTableCreate2" parameterType="hashmap">
			CREATE TABLE ROBOT01 (
    			USER_ID CHAR(20),
    			WRK_NM CHAR(20),
    			SOURCE LONGTEXT NOT NULL,
    			PRIMARY KEY (USER_ID, WRK_NM)
    		)

	</insert>
	
	<insert id="insertTableCreate3" parameterType="hashmap">
			CREATE TABLE ROBOT02 (
    			USER_ID CHAR(20),
    			 WRK_NM CHAR(20),
     			CHNG_HISTRY_DTTM TIMESTAMP,
     			SOURCE LONGTEXT NOT NULL,
     			PRIMARY KEY (USER_ID, WRK_NM, CHNG_HISTRY_DTTM),
     			FOREIGN KEY (USER_ID, WRK_NM) REFERENCES ROBOT01 (USER_ID, WRK_NM)
 			)
	</insert>
	
	<select id="selectLogin" parameterType="hashmap" resultType ="HashMap">


	    	/* retrieveLogin */
	    	
			SELECT CASE WHEN COUNT(*) = 0
            		THEN 'N'
					ELSE 'Y' END AS loginSuccessYn
			FROM USER01
			WHERE ID = #{id}
			<if test='dvsNm == "login"'>
			AND PASS = #{pass}    
			</if>
			

	</select>
	

</mapper>